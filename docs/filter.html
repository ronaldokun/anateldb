---

title: Filtragem


keywords: fastai
sidebar: home_sidebar

summary: "Este m√≥dulo concentra fun√ß√µes auxiliares espec√≠ficas que filtram os dados do banco com campos e formata√ß√£o de interesse para aplica√ß√µes espec√≠ficas como o <a href='https://github.com/EricMagalhaesDelgado/appAnalise'>appAnalise</a> por exemplo."
description: "Este m√≥dulo concentra fun√ß√µes auxiliares espec√≠ficas que filtram os dados do banco com campos e formata√ß√£o de interesse para aplica√ß√µes espec√≠ficas como o <a href='https://github.com/EricMagalhaesDelgado/appAnalise'>appAnalise</a> por exemplo."
nb_path: "nbs\filter.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs\filter.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bump_version" class="doc_header"><code>bump_version</code><a href="https://github.com/ronaldokun/anateldb/tree/master/anateldb/filter.py#L20" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bump_version</code>(<strong><code>version</code></strong>, <strong><code>part</code></strong>=<em><code>2</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="formatar_db" class="doc_header"><code>formatar_db</code><a href="https://github.com/ronaldokun/anateldb/tree/master/anateldb/filter.py#L108" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>formatar_db</code>(<strong><code>path</code></strong>:"Pasta onde salvar os arquivos", <strong><code>up_stel</code></strong>:"Atualizar a base do Stel"=<em><code>False</code></em>, <strong><code>up_radcom</code></strong>:"Atualizar a base do Radcom"=<em><code>False</code></em>, <strong><code>up_mosaico</code></strong>:"Atualizar a base do Mosaico"=<em><code>False</code></em>, <strong><code>up_icao</code></strong>:"Atualizar a base do ICAO"=<em><code>False</code></em>, <strong><code>up_pmec</code></strong>:"Atualizar a base do PMEC"=<em><code>False</code></em>, <strong><code>up_geo</code></strong>:"Atualizar a base do Geo"=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pasta</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;c:/Users/rsilva/AnatelDatabase&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="ow">not</span> <span class="n">pasta</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
    <span class="kn">import</span> <span class="nn">subprocess</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;git&#39;</span><span class="p">,</span> <span class="s1">&#39;clone&#39;</span><span class="p">,</span> <span class="s1">&#39;https://github.com/ronaldokun/AnatelDatabase.git&#39;</span><span class="p">])</span>
    <span class="n">pasta</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span> <span class="o">/</span> <span class="s1">&#39;AnatelDatabase&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">üìú<span style="color: #008000; text-decoration-color: #008000">Lendo as bases de dados...</span>
</pre>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea "><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">üóÉ<span style="color: #008000; text-decoration-color: #008000">Salvando os arquivos...</span>
</pre>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea "><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">üÜï <span style="color: #008000; text-decoration-color: #008000"> A base de dados mudou desde a √∫ltima atualiza√ß√£o! Salvando o novo arquivo e atualizando a</span>
<span style="color: #008000; text-decoration-color: #008000">vers√£o</span>
</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_feather</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pasta</span><span class="si">}</span><span class="s1">/AnatelDB.fth&#39;</span><span class="p">)</span> <span class="c1">#, engine=&#39;openpyxl&#39;, sheet_name=&#39;DataBase&#39;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequency</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Description</th>
      <th>Service</th>
      <th>Station</th>
      <th>Class</th>
      <th>BW</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>884055</th>
      <td>85469.0</td>
      <td>-1.358931</td>
      <td>-48.385670</td>
      <td>[STEL] L, FX, Tim S A (50417425295, 1009786951...</td>
      <td>19</td>
      <td>1009786951</td>
      <td>Q7W</td>
      <td>750M</td>
    </tr>
    <tr>
      <th>884056</th>
      <td>85469.0</td>
      <td>-9.937445</td>
      <td>-67.827751</td>
      <td>[STEL] L, FX, Tim S A (50417425295, 1005059940...</td>
      <td>19</td>
      <td>1005059940</td>
      <td>Q7W</td>
      <td>62M5</td>
    </tr>
    <tr>
      <th>884057</th>
      <td>85469.0</td>
      <td>-23.624083</td>
      <td>-46.623943</td>
      <td>[STEL] L, FX, Tim S A (50417425295, 1007183141...</td>
      <td>19</td>
      <td>1007183141</td>
      <td>Q7W</td>
      <td>62M5</td>
    </tr>
    <tr>
      <th>884058</th>
      <td>85469.0</td>
      <td>-19.857389</td>
      <td>-44.616112</td>
      <td>[STEL] L, FX, Tim S A (50417425295, 1009125734...</td>
      <td>19</td>
      <td>1009125734</td>
      <td>Q7W</td>
      <td>62M5</td>
    </tr>
    <tr>
      <th>884059</th>
      <td>85469.0</td>
      <td>-16.592699</td>
      <td>-49.267799</td>
      <td>[STEL] L, FX, Tim S A (50417425295, 1008754061...</td>
      <td>19</td>
      <td>1008754061</td>
      <td>Q7W</td>
      <td>62M5</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 884060 entries, 0 to 884059
Data columns (total 8 columns):
 #   Column       Non-Null Count   Dtype   
---  ------       --------------   -----   
 0   Frequency    884060 non-null  float64 
 1   Latitude     884060 non-null  float32 
 2   Longitude    884060 non-null  float32 
 3   Description  884060 non-null  string  
 4   Service      884060 non-null  int32   
 5   Station      884060 non-null  int32   
 6   Class        884060 non-null  category
 7   BW           884060 non-null  category
dtypes: category(2), float32(2), float64(1), int32(2), string(1)
memory usage: 29.5 MB
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">icao</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pasta</span><span class="si">}</span><span class="s1">/IcaoDB.xlsx&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;openpyxl&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;DataBase&#39;</span><span class="p">)</span>
<span class="n">pmec</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pasta</span><span class="si">}</span><span class="s1">/PmecDB.xlsx&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;openpyxl&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;DataBase&#39;</span><span class="p">)</span>
<span class="n">geo</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pasta</span><span class="si">}</span><span class="s1">/GeoAiswebDB.xlsx&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;openpyxl&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;DataBase&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">icao</span><span class="p">[</span><span class="n">icao</span><span class="o">.</span><span class="n">Station</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequency</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Description</th>
      <th>Service</th>
      <th>Station</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>109.1</td>
      <td>-25.600000</td>
      <td>-54.466667</td>
      <td>[FFD] ILS, FOZ DO IGUACU CATARATAS</td>
      <td>-1</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>109.3</td>
      <td>-1.366667</td>
      <td>-48.466667</td>
      <td>[FFD] ILS/DME, BELEM VAL DE CAES</td>
      <td>-1</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>109.3</td>
      <td>-15.866667</td>
      <td>-47.933334</td>
      <td>[FFD] ILS/DME, BRASILIA INTL.</td>
      <td>-1</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>109.3</td>
      <td>-25.533333</td>
      <td>-49.166668</td>
      <td>[FFD] ILS, CURITIBA AFONSO PE√ëA</td>
      <td>-1</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>109.3</td>
      <td>-9.516666</td>
      <td>-35.783333</td>
      <td>[FFD] ILS/DME, MACEIO</td>
      <td>-1</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2576</th>
      <td>1203.0</td>
      <td>-23.616667</td>
      <td>-46.650002</td>
      <td>[ICA] Ground-based DME</td>
      <td>-1</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>2577</th>
      <td>1204.0</td>
      <td>-29.933332</td>
      <td>-51.183334</td>
      <td>[ICA] Ground-based DME</td>
      <td>-1</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>2578</th>
      <td>1207.0</td>
      <td>-1.383333</td>
      <td>-48.483334</td>
      <td>[ICA] Ground-based DME</td>
      <td>-1</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>2579</th>
      <td>1209.0</td>
      <td>-4.183333</td>
      <td>-69.933334</td>
      <td>[ICA] Ground-based DME</td>
      <td>-1</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>2580</th>
      <td>1211.0</td>
      <td>-19.833334</td>
      <td>-44.000000</td>
      <td>[ICA] Ground-based DME</td>
      <td>-1</td>
      <td>-1</td>
    </tr>
  </tbody>
</table>
<p>1102 rows √ó 6 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pmec</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 946 entries, 0 to 945
Data columns (total 6 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   Frequency    946 non-null    float64
 1   Latitude     946 non-null    float64
 2   Longitude    946 non-null    float64
 3   Description  946 non-null    object 
 4   Service      946 non-null    int64  
 5   Station      946 non-null    int64  
dtypes: float64(3), int64(2), object(1)
memory usage: 44.5+ KB
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">icao</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(2581, 6)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pmec</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(946, 6)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">geo</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(286, 6)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;Station&#39;</span><span class="p">]</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">icao</span><span class="p">,</span> <span class="n">pmec</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">geo</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">Description_x</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">Description_y</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
<span class="n">df2</span><span class="p">[</span><span class="n">y</span> <span class="o">&amp;</span> <span class="n">z</span>  <span class="o">&amp;</span> <span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">Station</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequency</th>
      <th>Latitude_x</th>
      <th>Longitude_x</th>
      <th>Description_x</th>
      <th>Service_x</th>
      <th>Station</th>
      <th>Latitude_y</th>
      <th>Longitude_y</th>
      <th>Description_y</th>
      <th>Service_y</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Description</th>
      <th>Service</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>209</th>
      <td>112.1</td>
      <td>-9.366667</td>
      <td>-40.566666</td>
      <td>[FFD] VOR/DME, PETROLINA</td>
      <td>108.0</td>
      <td>1000842573</td>
      <td>-9.363334</td>
      <td>-40.561501</td>
      <td>[AIS] SBPL-RDONAV, VOR/DME PTL, SENADOR NILO C...</td>
      <td>108.0</td>
      <td>-9.363261</td>
      <td>-40.561577</td>
      <td>[GEOAISWEB] VOR - PETROLINA OPR INFRAERO</td>
      <td>108.0</td>
    </tr>
    <tr>
      <th>212</th>
      <td>112.2</td>
      <td>-6.233333</td>
      <td>-57.766666</td>
      <td>[FFD] VOR/DME, JACAREACANGA</td>
      <td>108.0</td>
      <td>1000842433</td>
      <td>-6.235667</td>
      <td>-57.770500</td>
      <td>[AIS] SBEK-RDONAV, VOR/DME JAC, Jacareacanga</td>
      <td>108.0</td>
      <td>-6.235744</td>
      <td>-57.770527</td>
      <td>[GEOAISWEB] VOR - JACAREACANGA VOR NO AVBL SEC...</td>
      <td>108.0</td>
    </tr>
    <tr>
      <th>215</th>
      <td>112.3</td>
      <td>-2.450000</td>
      <td>-54.816666</td>
      <td>[FFD] VOR/DME, SANTAREM INTL.</td>
      <td>108.0</td>
      <td>1000823129</td>
      <td>-2.426500</td>
      <td>-54.817501</td>
      <td>[AIS] SBSN-RDONAV, VOR/DME STM, Maestro Wilson...</td>
      <td>108.0</td>
      <td>-2.426419</td>
      <td>-54.817562</td>
      <td>[GEOAISWEB] VOR - SANTAR√âM OPR INFRAERO</td>
      <td>108.0</td>
    </tr>
    <tr>
      <th>218</th>
      <td>112.4</td>
      <td>-23.333334</td>
      <td>-51.116665</td>
      <td>[FFD] VOR/DME, LONDRINA</td>
      <td>108.0</td>
      <td>1000822874</td>
      <td>-23.339500</td>
      <td>-51.112499</td>
      <td>[AIS] SBLO-RDONAV, VOR/DME LON, Governador Jos...</td>
      <td>108.0</td>
      <td>-23.339516</td>
      <td>-51.112526</td>
      <td>[GEOAISWEB] VOR - LONDRINA CH 71XOPR INFRAERO</td>
      <td>108.0</td>
    </tr>
    <tr>
      <th>227</th>
      <td>112.7</td>
      <td>-5.516667</td>
      <td>-47.450001</td>
      <td>[FFD] VOR/DME, IMPERATRIZ</td>
      <td>108.0</td>
      <td>1000842417</td>
      <td>-5.523833</td>
      <td>-47.449833</td>
      <td>[AIS] SBIZ-RDONAV, VOR/DME YTZ, PREFEITO RENAT...</td>
      <td>108.0</td>
      <td>-5.523889</td>
      <td>-47.449844</td>
      <td>[GEOAISWEB] VOR - IMPERATRIZ CH 74XOPR INFRAERO</td>
      <td>108.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4078</th>
      <td>1178.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1000842506</td>
      <td>-6.119667</td>
      <td>-50.001999</td>
      <td>[ICA] Ground-based DME</td>
      <td>108.0</td>
      <td>-6.119645</td>
      <td>-50.001995</td>
      <td>[GEOAISWEB] DME - CARAJ√ÅS 91X</td>
      <td>108.0</td>
    </tr>
    <tr>
      <th>4079</th>
      <td>1185.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1000822831</td>
      <td>-26.222334</td>
      <td>-48.798000</td>
      <td>[ICA] Ground-based DME</td>
      <td>108.0</td>
      <td>-26.222261</td>
      <td>-48.798046</td>
      <td>[GEOAISWEB] DME - JOINVILLE 98X</td>
      <td>108.0</td>
    </tr>
    <tr>
      <th>4084</th>
      <td>1193.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1000822904</td>
      <td>-22.344500</td>
      <td>-41.769001</td>
      <td>[ICA] Ground-based DME</td>
      <td>108.0</td>
      <td>-22.344448</td>
      <td>-41.769001</td>
      <td>[GEOAISWEB] DME - MACA√â 106X</td>
      <td>108.0</td>
    </tr>
    <tr>
      <th>4085</th>
      <td>1195.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1000823692</td>
      <td>-18.876667</td>
      <td>-48.221333</td>
      <td>[ICA] Ground-based DME</td>
      <td>108.0</td>
      <td>-18.876610</td>
      <td>-48.221298</td>
      <td>[GEOAISWEB] DME - UBERL√ÇNDIA 108X</td>
      <td>108.0</td>
    </tr>
    <tr>
      <th>4086</th>
      <td>1198.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1000823781</td>
      <td>-20.260166</td>
      <td>-40.285000</td>
      <td>[ICA] Ground-based DME</td>
      <td>108.0</td>
      <td>-20.260166</td>
      <td>-40.285000</td>
      <td>[GEOAISWEB] DME - VIT√ìRIA 111X</td>
      <td>108.0</td>
    </tr>
  </tbody>
</table>
<p>65 rows √ó 14 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">para</span> <span class="n">Station</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">pegar</span> <span class="n">s√≥</span> <span class="n">descri√ß√£o</span> <span class="o">|</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">hdf5storage</span> <span class="k">as</span> <span class="nn">hdf</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">db</span> <span class="o">=</span> <span class="n">hdf</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pasta</span><span class="si">}</span><span class="s1">/AnatelDB.mat&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">db</span> <span class="o">=</span> <span class="n">hdf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;/c/Users/rsilva/db/&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;AnatelDB.mat&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">FileNotFoundError</span>                         Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">c:\Users\rsilva\anateldb\nbs\filter.ipynb Cell 23&#39;</span> in <span class="ansi-cyan-fg">&lt;cell line: 1&gt;</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; &lt;a href=&#39;vscode-notebook-cell:/c%3A/Users/rsilva/anateldb/nbs/filter.ipynb#ch0000048?line=0&#39;&gt;1&lt;/a&gt;</span> db = hdf.read(path=&#39;/c/Users/rsilva/db/&#39;, filename=&#39;AnatelDB.mat&#39;)

File <span class="ansi-green-intense-fg ansi-bold">~\Miniconda3\envs\db\lib\site-packages\hdf5storage\__init__.py:1566</span>, in <span class="ansi-cyan-fg">read</span><span class="ansi-blue-intense-fg ansi-bold">(path, filename, options, **keywords)</span>
<span class="ansi-green-fg">   &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1514&#39;&gt;1515&lt;/a&gt;</span> def read(path=&#39;/&#39;, filename=&#39;data.h5&#39;,
<span class="ansi-green-fg">   &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1515&#39;&gt;1516&lt;/a&gt;</span>          options=None, **keywords):
<span class="ansi-green-fg">   &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1516&#39;&gt;1517&lt;/a&gt;</span>     &#34;&#34;&#34; Reads one piece of data from an HDF5 file (high level).
<span class="ansi-green-fg">   &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1517&#39;&gt;1518&lt;/a&gt;</span> 
<span class="ansi-green-fg">   &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1518&#39;&gt;1519&lt;/a&gt;</span>     A wrapper around ``reads`` to read a single piece of data at the
<span class="ansi-green-intense-fg ansi-bold">   (...)</span>
<span class="ansi-green-fg">   &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1563&#39;&gt;1564&lt;/a&gt;</span> 
<span class="ansi-green-fg">   &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1564&#39;&gt;1565&lt;/a&gt;</span>     &#34;&#34;&#34;
<span class="ansi-green-intense-fg ansi-bold">-&gt; &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1565&#39;&gt;1566&lt;/a&gt;</span>     return reads(paths=(path,), filename=filename, options=options,
<span class="ansi-green-fg">   &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1566&#39;&gt;1567&lt;/a&gt;</span>                  **keywords)[0]

File <span class="ansi-green-intense-fg ansi-bold">~\Miniconda3\envs\db\lib\site-packages\hdf5storage\__init__.py:1491</span>, in <span class="ansi-cyan-fg">reads</span><span class="ansi-blue-intense-fg ansi-bold">(paths, filename, options, **keywords)</span>
<span class="ansi-green-fg">   &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1488&#39;&gt;1489&lt;/a&gt;</span> try:
<span class="ansi-green-fg">   &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1489&#39;&gt;1490&lt;/a&gt;</span>     f = None
<span class="ansi-green-intense-fg ansi-bold">-&gt; &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1490&#39;&gt;1491&lt;/a&gt;</span>     f = h5py.File(filename, mode=&#39;r&#39;)
<span class="ansi-green-fg">   &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1492&#39;&gt;1493&lt;/a&gt;</span>     # Read the data item by item
<span class="ansi-green-fg">   &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/hdf5storage/__init__.py?line=1493&#39;&gt;1494&lt;/a&gt;</span>     datas = []

File <span class="ansi-green-intense-fg ansi-bold">~\Miniconda3\envs\db\lib\site-packages\h5py\_hl\files.py:507</span>, in <span class="ansi-cyan-fg">File.__init__</span><span class="ansi-blue-intense-fg ansi-bold">(self, name, mode, driver, libver, userblock_size, swmr, rdcc_nslots, rdcc_nbytes, rdcc_w0, track_order, fs_strategy, fs_persist, fs_threshold, fs_page_size, page_buf_size, min_meta_keep, min_raw_keep, locking, **kwds)</span>
<span class="ansi-green-fg">    &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=501&#39;&gt;502&lt;/a&gt;</span>     fapl = make_fapl(driver, libver, rdcc_nslots, rdcc_nbytes, rdcc_w0,
<span class="ansi-green-fg">    &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=502&#39;&gt;503&lt;/a&gt;</span>                      locking, page_buf_size, min_meta_keep, min_raw_keep, **kwds)
<span class="ansi-green-fg">    &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=503&#39;&gt;504&lt;/a&gt;</span>     fcpl = make_fcpl(track_order=track_order, fs_strategy=fs_strategy,
<span class="ansi-green-fg">    &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=504&#39;&gt;505&lt;/a&gt;</span>                      fs_persist=fs_persist, fs_threshold=fs_threshold,
<span class="ansi-green-fg">    &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=505&#39;&gt;506&lt;/a&gt;</span>                      fs_page_size=fs_page_size)
<span class="ansi-green-intense-fg ansi-bold">--&gt; &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=506&#39;&gt;507&lt;/a&gt;</span>     fid = make_fid(name, mode, userblock_size, fapl, fcpl, swmr=swmr)
<span class="ansi-green-fg">    &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=508&#39;&gt;509&lt;/a&gt;</span> if isinstance(libver, tuple):
<span class="ansi-green-fg">    &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=509&#39;&gt;510&lt;/a&gt;</span>     self._libver = libver

File <span class="ansi-green-intense-fg ansi-bold">~\Miniconda3\envs\db\lib\site-packages\h5py\_hl\files.py:220</span>, in <span class="ansi-cyan-fg">make_fid</span><span class="ansi-blue-intense-fg ansi-bold">(name, mode, userblock_size, fapl, fcpl, swmr)</span>
<span class="ansi-green-fg">    &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=217&#39;&gt;218&lt;/a&gt;</span>     if swmr and swmr_support:
<span class="ansi-green-fg">    &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=218&#39;&gt;219&lt;/a&gt;</span>         flags |= h5f.ACC_SWMR_READ
<span class="ansi-green-intense-fg ansi-bold">--&gt; &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=219&#39;&gt;220&lt;/a&gt;</span>     fid = h5f.open(name, flags, fapl=fapl)
<span class="ansi-green-fg">    &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=220&#39;&gt;221&lt;/a&gt;</span> elif mode == &#39;r+&#39;:
<span class="ansi-green-fg">    &lt;a href=&#39;file:///c%3A/Users/rsilva/Miniconda3/envs/db/lib/site-packages/h5py/_hl/files.py?line=221&#39;&gt;222&lt;/a&gt;</span>     fid = h5f.open(name, h5f.ACC_RDWR, fapl=fapl)

File <span class="ansi-green-intense-fg ansi-bold">h5py\_objects.pyx:54</span>, in <span class="ansi-cyan-fg">h5py._objects.with_phil.wrapper</span><span class="ansi-blue-intense-fg ansi-bold">()</span>

File <span class="ansi-green-intense-fg ansi-bold">h5py\_objects.pyx:55</span>, in <span class="ansi-cyan-fg">h5py._objects.with_phil.wrapper</span><span class="ansi-blue-intense-fg ansi-bold">()</span>

File <span class="ansi-green-intense-fg ansi-bold">h5py\h5f.pyx:106</span>, in <span class="ansi-cyan-fg">h5py.h5f.open</span><span class="ansi-blue-intense-fg ansi-bold">()</span>

<span class="ansi-red-intense-fg ansi-bold">FileNotFoundError</span>: [Errno 2] Unable to open file (unable to open file: name = &#39;AnatelDB.mat&#39;, errno = 2, error message = &#39;No such file or directory&#39;, flags = 0, o_flags = 0)</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># import matplotlib.pyplot as plt</span>


<span class="c1"># ax = sns.countplot(x=&quot;Num_Servi√ßo&quot;, data=base)</span>

<span class="c1"># plt.rcParams[&quot;figure.figsize&quot;] = [30, 20]</span>
<span class="c1"># plt.rcParams[&quot;figure.autolayout&quot;] = True</span>

<span class="c1"># for p in ax.patches:</span>
<span class="c1">#     ax.annotate(&#39;{:.1f}&#39;.format(int(p.get_height())), (p.get_x()+0.05, p.get_height()+0.02))</span>
    
<span class="c1"># plt.title(f&quot;Total de Entidades: {base.shape[0]}&quot;)</span>
<span class="c1"># plt.xlabel(&quot;C√≥digo Servi√ßo&quot;)</span>

<span class="c1"># plt.savefig(&quot;Stats.png&quot;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">base</span> <span class="o">=</span> <span class="n">read_base</span><span class="p">(</span><span class="n">pasta</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">base</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequ√™ncia</th>
      <th>Num_Servi√ßo</th>
      <th>Status</th>
      <th>Classe</th>
      <th>Entidade</th>
      <th>Fistel</th>
      <th>N√∫mero_da_Esta√ß√£o</th>
      <th>Munic√≠pio</th>
      <th>UF</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Validade_RF</th>
      <th>Num_Ato</th>
      <th>Data_Ato</th>
      <th>Fonte</th>
      <th>Classe_Emiss√£o</th>
      <th>Largura_Emiss√£o</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0280</td>
      <td>19</td>
      <td>L</td>
      <td>OP</td>
      <td>FURNAS CENTRAIS ELETRICAS S A</td>
      <td>01030052263</td>
      <td>1557670</td>
      <td>Nova Igua√ßu</td>
      <td>RJ</td>
      <td>-22.662777</td>
      <td>-43.476387</td>
      <td>2033-08-17</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>J9E</td>
      <td>8K00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0285</td>
      <td>19</td>
      <td>L</td>
      <td>OP</td>
      <td>COMPANHIA DE GERA√á√ÉO E TRANSMISS√ÉO DE ENERGIA ...</td>
      <td>50420217282</td>
      <td>1494686</td>
      <td>Joinville</td>
      <td>SC</td>
      <td>-26.292500</td>
      <td>-48.887222</td>
      <td>2025-08-31</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>R3E</td>
      <td>2K50</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0300</td>
      <td>19</td>
      <td>L</td>
      <td>OP</td>
      <td>FURNAS CENTRAIS ELETRICAS S A</td>
      <td>01030052263</td>
      <td>859966</td>
      <td>Arapor√£</td>
      <td>MG</td>
      <td>-18.410000</td>
      <td>-49.099998</td>
      <td>2033-08-17</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>J3E</td>
      <td>1K00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0300</td>
      <td>19</td>
      <td>L</td>
      <td>OP</td>
      <td>FURNAS CENTRAIS ELETRICAS S A</td>
      <td>01030052263</td>
      <td>859753</td>
      <td>Campinas</td>
      <td>SP</td>
      <td>-22.774166</td>
      <td>-47.004444</td>
      <td>2033-08-17</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>J3E</td>
      <td>1K00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0300</td>
      <td>19</td>
      <td>L</td>
      <td>OP</td>
      <td>FURNAS CENTRAIS ELETRICAS S A</td>
      <td>01030052263</td>
      <td>1557823</td>
      <td>S√£o Paulo</td>
      <td>SP</td>
      <td>-23.441668</td>
      <td>-46.590832</td>
      <td>2033-08-17</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>J3E</td>
      <td>1K00</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Frequ√™ncia&#39;</span><span class="p">,</span> <span class="s1">&#39;Num_Servi√ßo&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">,</span> <span class="s1">&#39;Classe&#39;</span><span class="p">,</span> <span class="s1">&#39;Fistel&#39;</span><span class="p">,</span> <span class="s1">&#39;N√∫mero_da_Esta√ß√£o&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Classe_Emiss√£o&#39;</span><span class="p">,</span> <span class="s1">&#39;Largura_Emiss√£o&#39;</span><span class="p">]</span>
<span class="c1"># double = base.duplicated(subset=subset, keep=False)</span>
<span class="c1"># base[double]</span>

<span class="n">base</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(881692, 17)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">subset</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="c1"># double = base.duplicated(subset=subset, keep=&#39;first&#39;)</span>
<span class="c1"># base[double]</span>

<span class="n">base</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># base.shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequ√™ncia</th>
      <th>Num_Servi√ßo</th>
      <th>Status</th>
      <th>Classe</th>
      <th>Entidade</th>
      <th>Fistel</th>
      <th>N√∫mero_da_Esta√ß√£o</th>
      <th>Munic√≠pio</th>
      <th>UF</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Validade_RF</th>
      <th>Num_Ato</th>
      <th>Data_Ato</th>
      <th>Fonte</th>
      <th>Classe_Emiss√£o</th>
      <th>Largura_Emiss√£o</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>26</th>
      <td>0.038</td>
      <td>19</td>
      <td>L</td>
      <td>OP</td>
      <td>LIGHT SERVICOS DE ELETRICIDADE S A</td>
      <td>01030063621</td>
      <td>756830</td>
      <td>Pira√≠</td>
      <td>RJ</td>
      <td>-22.629444</td>
      <td>-43.895832</td>
      <td>2028-12-12</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>N0N</td>
      <td>1K00</td>
    </tr>
    <tr>
      <th>33</th>
      <td>0.040</td>
      <td>19</td>
      <td>L</td>
      <td>OP</td>
      <td>LIGHT SERVICOS DE ELETRICIDADE S A</td>
      <td>01030063621</td>
      <td>758124</td>
      <td>Petr√≥polis</td>
      <td>RJ</td>
      <td>-22.433332</td>
      <td>-43.166668</td>
      <td>2028-12-12</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>A3E</td>
      <td>5K00</td>
    </tr>
    <tr>
      <th>37</th>
      <td>0.040</td>
      <td>19</td>
      <td>L</td>
      <td>OP</td>
      <td>LIGHT SERVICOS DE ELETRICIDADE S A</td>
      <td>01030063621</td>
      <td>758051</td>
      <td>Carmo</td>
      <td>RJ</td>
      <td>-21.840000</td>
      <td>-42.570000</td>
      <td>2028-12-12</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>N0N</td>
      <td>1K00</td>
    </tr>
    <tr>
      <th>58</th>
      <td>0.044</td>
      <td>19</td>
      <td>L</td>
      <td>OP</td>
      <td>LIGHT SERVICOS DE ELETRICIDADE S A</td>
      <td>01030063621</td>
      <td>814180</td>
      <td>Volta Redonda</td>
      <td>RJ</td>
      <td>-22.513611</td>
      <td>-44.089722</td>
      <td>2028-12-12</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>A3E</td>
      <td>5K00</td>
    </tr>
    <tr>
      <th>62</th>
      <td>0.045</td>
      <td>19</td>
      <td>L</td>
      <td>OP</td>
      <td>LIGHT SERVICOS DE ELETRICIDADE S A</td>
      <td>01030063621</td>
      <td>749680</td>
      <td>Rio de Janeiro</td>
      <td>RJ</td>
      <td>-22.966667</td>
      <td>-43.233334</td>
      <td>2028-12-12</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>A3E</td>
      <td>5K00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>883461</th>
      <td>82125.000</td>
      <td>19</td>
      <td>L</td>
      <td>FX</td>
      <td>TIM S A</td>
      <td>50417425295</td>
      <td>1007302558</td>
      <td>Ribeir√£o das Neves</td>
      <td>MG</td>
      <td>-19.768250</td>
      <td>-44.082527</td>
      <td>2032-08-31</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>Q7W</td>
      <td>62M5</td>
    </tr>
    <tr>
      <th>883467</th>
      <td>82125.000</td>
      <td>19</td>
      <td>L</td>
      <td>FX</td>
      <td>TIM S A</td>
      <td>50417425295</td>
      <td>1005319658</td>
      <td>Uberl√¢ndia</td>
      <td>MG</td>
      <td>-18.942499</td>
      <td>-48.300556</td>
      <td>2032-08-31</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>Q7W</td>
      <td>62M5</td>
    </tr>
    <tr>
      <th>883481</th>
      <td>82125.000</td>
      <td>19</td>
      <td>L</td>
      <td>FX</td>
      <td>TIM S A</td>
      <td>50417425295</td>
      <td>1005325984</td>
      <td>Arax√°</td>
      <td>MG</td>
      <td>-19.582222</td>
      <td>-46.953888</td>
      <td>2032-08-31</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>Q7W</td>
      <td>62M5</td>
    </tr>
    <tr>
      <th>883514</th>
      <td>82125.000</td>
      <td>19</td>
      <td>L</td>
      <td>FX</td>
      <td>TIM S A</td>
      <td>50417425295</td>
      <td>1008765390</td>
      <td>Aparecida de Goi√¢nia</td>
      <td>GO</td>
      <td>-16.805166</td>
      <td>-49.329556</td>
      <td>2032-08-31</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>Q7W</td>
      <td>62M5</td>
    </tr>
    <tr>
      <th>883530</th>
      <td>82125.000</td>
      <td>19</td>
      <td>L</td>
      <td>FX</td>
      <td>TIM S A</td>
      <td>50417425295</td>
      <td>1005304065</td>
      <td>Sabar√°</td>
      <td>MG</td>
      <td>-19.897028</td>
      <td>-43.807056</td>
      <td>2032-08-31</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>Q7W</td>
      <td>62M5</td>
    </tr>
  </tbody>
</table>
<p>260770 rows √ó 17 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">base</span><span class="p">[</span><span class="n">base</span><span class="o">.</span><span class="n">N√∫mero_da_Esta√ß√£o</span> <span class="o">==</span> <span class="mi">1005304065</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequ√™ncia</th>
      <th>Num_Servi√ßo</th>
      <th>Status</th>
      <th>Classe</th>
      <th>Entidade</th>
      <th>Fistel</th>
      <th>N√∫mero_da_Esta√ß√£o</th>
      <th>Munic√≠pio</th>
      <th>UF</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Validade_RF</th>
      <th>Num_Ato</th>
      <th>Data_Ato</th>
      <th>Fonte</th>
      <th>Classe_Emiss√£o</th>
      <th>Largura_Emiss√£o</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>744796</th>
      <td>8118.32</td>
      <td>19</td>
      <td>L</td>
      <td>FX</td>
      <td>TIM S A</td>
      <td>50417425295</td>
      <td>1005304065</td>
      <td>Sabar√°</td>
      <td>MG</td>
      <td>-19.897028</td>
      <td>-43.807056</td>
      <td>2032-08-31</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>D7W</td>
      <td>29M7</td>
    </tr>
    <tr>
      <th>825221</th>
      <td>19343.00</td>
      <td>19</td>
      <td>L</td>
      <td>FX</td>
      <td>TIM S A</td>
      <td>50417425295</td>
      <td>1005304065</td>
      <td>Sabar√°</td>
      <td>MG</td>
      <td>-19.897028</td>
      <td>-43.807056</td>
      <td>2032-08-31</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>D7W</td>
      <td>55M0</td>
    </tr>
    <tr>
      <th>831552</th>
      <td>19453.00</td>
      <td>19</td>
      <td>L</td>
      <td>FX</td>
      <td>TIM S A</td>
      <td>50417425295</td>
      <td>1005304065</td>
      <td>Sabar√°</td>
      <td>MG</td>
      <td>-19.897028</td>
      <td>-43.807056</td>
      <td>2032-08-31</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>D7W</td>
      <td>55M0</td>
    </tr>
    <tr>
      <th>865366</th>
      <td>23275.00</td>
      <td>19</td>
      <td>L</td>
      <td>FX</td>
      <td>TIM S A</td>
      <td>50417425295</td>
      <td>1005304065</td>
      <td>Sabar√°</td>
      <td>MG</td>
      <td>-19.897028</td>
      <td>-43.807056</td>
      <td>2032-08-31</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>D7W</td>
      <td>56M0</td>
    </tr>
    <tr>
      <th>881466</th>
      <td>82125.00</td>
      <td>19</td>
      <td>L</td>
      <td>FX</td>
      <td>TIM S A</td>
      <td>50417425295</td>
      <td>1005304065</td>
      <td>Sabar√°</td>
      <td>MG</td>
      <td>-19.897028</td>
      <td>-43.807056</td>
      <td>2032-08-31</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>G7W</td>
      <td>2G00</td>
    </tr>
    <tr>
      <th>881467</th>
      <td>82125.00</td>
      <td>19</td>
      <td>L</td>
      <td>FX</td>
      <td>TIM S A</td>
      <td>50417425295</td>
      <td>1005304065</td>
      <td>Sabar√°</td>
      <td>MG</td>
      <td>-19.897028</td>
      <td>-43.807056</td>
      <td>2032-08-31</td>
      <td>-1</td>
      <td></td>
      <td>STEL</td>
      <td>Q7W</td>
      <td>62M5</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.export</span> <span class="kn">import</span> <span class="n">notebook2script</span><span class="p">;</span> <span class="n">notebook2script</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted constants.ipynb.
Converted filter.ipynb.
Converted index.ipynb.
Converted queries.ipynb.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

